@startuml ECサイト_クラス図_ID修正版
skinparam classAttributeIconSize 0

' ---------------------------------------
' 1. 顧客・ドメインクラス (左側)
' ---------------------------------------
class ユーザー {
  - ID : Integer <<PK>>
  --
  - 氏名 : String
  - メールアドレス : String
  - 住所 : String
  - 郵便番号 : String
  - 電話番号 : String
  
  + 新規登録する()
  + ログインする()
  + 登録情報を変更する()
  + アカウントを削除する()
  + 退会する()
}

class カート {
  - ID : Integer <<PK>>
  - ユーザーID : Integer <<FK>>
  --
  - 作成日時 : DateTime
  
  + 商品をカートに追加する(商品, 数量)
  + 商品を削除する(商品)
  + 注文に変換する()
}

class 商品 {
  - 商品コード : String <<PK>>
  --
  - 商品名 : String
  - 価格_単価 : Decimal
  - 在庫数 : Integer
  
  + 情報を表示する()
}


' ---------------------------------------
' 2. 注文・取引クラス (中央)
' ---------------------------------------
class 注文 {
  - ID : Integer <<PK>>
  - ユーザーID : Integer <<FK>>
  - 配送ID : Integer <<FK>>
  - 決済ID : Integer <<FK>>
  --
  - 注文日時 : DateTime
  - 合計金額 : Decimal
  
  + 注文を確定する()
  + 注文をキャンセルする()
  + 決済ログと関連付ける()
}

class 注文明細 {
  - ID : Integer <<PK>>
  - 注文ID : Integer <<FK>>
  - 商品コード : String <<FK>>
  --
  - 数量 : Integer
  - 単価 : Decimal
}

class 決済 {
  - ID : Integer <<PK>>
  --
  - 決済ステータス : String
  - 決済ログ詳細 : Text
  
  + 決済を実行する(金額)
}

class 配送 {
  - ID : Integer <<PK>>
  --
  - 配達予定日 : Date
  - 配達ステータス : String
  - 配送先住所 : String
  
  + 配達状況を更新する(新しいステータス)
  + 配達予定日のメールを送信する()
  + 配達完了メールを送信する()
}

class 返品 {
  - ID : Integer <<PK>>
  - 注文ID : Integer <<FK>>
  --
  - 返品日時 : DateTime
  + 返品を申請する()
}

class 返金 {
  - ID : Integer <<PK>>
  - 返品ID : Integer <<FK>>
  --
  - 返金ステータス : String
  - 返金処理日時 : DateTime
  + 返金処理を実行する()
}


' ---------------------------------------
' 3. 管理クラス群 (右側/上部)
' ---------------------------------------
class サイト管理者 {
  - ID : Integer <<PK>>
  --
  - ログインID : String
  + ログインする()
  + ログアウトする()
}
class 在庫管理者 extends サイト管理者 {
  + 在庫数を更新する()
  + 商品を登録する()
  + 商品情報を変更する()
  + 商品を削除する()
}
class ユーザー管理者 extends サイト管理者 {
  + 顧客アカウントを削除する()
  + 顧客アカウントを停止する()
  + 管理者アカウントを追加する()
}
class カスタマーサポート extends サイト管理者 {
  + 顧客の注文履歴を確認する()
  + 返品返金に対応する()
}
class 配送管理者 extends サイト管理者 {
  + 配送対象の注文を確認する()
  + 配送ステータスを更新する()
}


' ---------------------------------------
' クラス間の関連付け (多重度を明記)
' ---------------------------------------

ユーザー "1" -- "*" 注文 : 注文する
ユーザー "1" -- "*" 返品 : 依頼する
ユーザー "1" -- "*" カート : 保持する 

カート "1" -- "*" 注文 : 変換される
注文 "1" -- "*" 注文明細 : 含む
注文明細 "*" -- "1" 商品 : 対象商品

注文 "1" -- "1" 配送 : 配送情報
注文 "1" -- "1" 決済 : 決済情報
注文 "1" -- "1" 返品 : 返品対象
返品 "1" -- "1" 返金 : 処理される

在庫管理者 "*" -- "*" 商品 : 管理する
ユーザー管理者 "*" -- "*" ユーザー : 管理する
カスタマーサポート "*" -- "*" 返品 : 対応する
カスタマーサポート "*" -- "*" 返金 : 対応する
配送管理者 "*" -- "*" 配送 : 依頼/管理

@enduml